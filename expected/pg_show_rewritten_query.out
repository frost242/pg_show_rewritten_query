CREATE EXTENSION pg_show_rewritten_query;
CREATE TABLE t_query_def(id integer, dpt integer, nb numeric);
CREATE VIEW v_query_def AS SELECT dpt, sum(nb) AS sum_nb
FROM t_query_def WHERE dpt IS NOT NULL GROUP BY dpt;
SELECT pg_show_rewritten_query('SELECT * FROM v_query_def');
             pg_show_rewritten_query              
--------------------------------------------------
  SELECT dpt,                                    +
     sum_nb                                      +
    FROM ( SELECT t_query_def.dpt,               +
             sum(t_query_def.nb) AS sum_nb       +
            FROM t_query_def                     +
           WHERE t_query_def.dpt IS NOT NULL     +
           GROUP BY t_query_def.dpt) v_query_def;+
 
(1 row)

